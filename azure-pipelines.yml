trigger:
- main  

pool:
  vmImage: 'ubuntu-latest'

variables:
  - group: 'my_group'  

stages:
- stage: ReadSecrets
  jobs:
  - job: ReadSecrets
    steps:
    - task: AzureKeyVault@2
      inputs:
        azureSubscription: '<your-service-connection-name>'  
        keyVaultName: '<your-keyvault-name>' 
        secretsFilter: '*'
        runAsPreJob: true

    - script: |
        echo "##vso[task.setvariable variable=MY_SECRET_VAR;issecret=true]$(MY_SECRET_NAME)"
      displayName: 'Store secrets in variable group'

